!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("lodash.merge"),require("lodash.groupby")):"function"==typeof define&&define.amd?define(["lodash.merge","lodash.groupby"],o):t.chartjsWPluginWaterfall=o(t._.merge,t._.groupby)}(this,function(t,o){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,o=o&&o.hasOwnProperty("default")?o.default:o;var a=function(t){var a=t.ctx,e=t.data.datasets,s=t.options.plugins.waterFallPlugin.stepLines,n=o(e,"stack"),r=[],l=function(t){var o=Object.keys(t._meta)[0];return t._meta[o].data[0]._model};Object.keys(n).forEach(function(t){var o=n[t],a=l(o.find(function(t){return!t.dummyStack})),e=l(o[0]),s=l(o[o.length-1]);r.push({stackRightXPos:e.x+e.width/2,stackLeftXPos:e.x-e.width/2,stackRealBottomYPos:a.base,stackBottomYPos:e.base,stackTopYPos:s.y})});for(var i=0;i<r.length;i+=1){var c=r[i];if(i!==r.length-1){var d=r[i+1];c.stackTopYPos===d.stackRealBottomYPos?d.stackTopYPos=d.stackRealBottomYPos:c.stackRealBottomYPos===d.stackTopYPos&&(c.stackTopYPos=c.stackRealBottomYPos);var p=a.createLinearGradient(0,d.stackTopYPos,0,d.stackBottomYPos);p.addColorStop(s.startColorStop,s.startColor),p.addColorStop(s.endColorStop,s.endColor),a.fillStyle=p,a.beginPath(),a.lineTo(c.stackRightXPos,c.stackTopYPos),a.lineTo(d.stackLeftXPos,d.stackTopYPos),a.lineTo(d.stackLeftXPos,d.stackBottomYPos),a.lineTo(c.stackRightXPos,c.stackBottomYPos),a.fill()}}},e={waterFallPlugin:{stepLines:{enabled:!0,startColorStop:0,endColorStop:.6,startColor:"rgba(0, 0, 0, 0.55)",endColor:"rgba(0, 0, 0, 0)"},_status:{readyToDrawStepLines:!1}}},s=function(t,o){return!o.datasets[t.datasetIndex].dummyStack};return{afterRender:function(t){var o=t.options.animation.onComplete;t.options.animation.onComplete=function(){t.options.plugins.waterFallPlugin._status.readyToDrawStepLines=!0,a(t),o.apply(void 0,arguments)}},afterInit:function(o){o.options.plugins=t({},e,o.options.plugins),o.options.tooltips.filter=s,o.options.legend.labels.filter=s,o.data.datasets.forEach(function(t,o){t.dummyStack&&(t.label="dummyStack_"+o,t.backgroundColor="rgba(0, 0, 0, 0)")})},afterDraw:function(t){var o=t.options.plugins.waterFallPlugin;o.stepLines.enabled&&o._status.readyToDrawStepLines&&a(t)}}});
//# sourceMappingURL=chartjs-plugin-waterfall.min.js.map
